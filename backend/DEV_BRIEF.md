–î–∞, –≤ —ç—Ç–æ—Ç —Ä–∞–∑ –Ω–µ —Ä–µ–∂—É. –ù–∏–∂–µ ‚Äî **–ø–æ–ª–Ω—ã–π DEV_BRIEF.md** –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –≤–∏–¥–µ, —Ç–æ–ª—å–∫–æ —Å –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º –±–ª–æ–∫–æ–º **`## Landing Status (Frozen)`** (—è –≤—Å—Ç–∞–≤–∏–ª –µ–≥–æ –ø–æ—Å–ª–µ –±–ª–æ–∫–∞ –ø—Ä–æ Phase 11.3 –∏ –¥–æ –ø–µ—Ä–≤–æ–≥–æ `---`). –õ–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤ –∏ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫ –≤–æ–∫—Ä—É–≥ –Ω–æ–≤–æ–≥–æ –±–ª–æ–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª—è–ª.

````markdown
# DEV_BRIEF.md ‚Äî Cleaning SaaS

(Frontend / Mobile integration guide)

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å (Phase 9)**

‚Äì Backend: auth, jobs, check-in / check-out, checklist, photos, PDF ‚Äî –≥–æ—Ç–æ–≤—ã.
‚Äì Mobile Cleaner App: login, Today Jobs, Job Details, check-in / check-out, –∑–∞–≥—Ä—É–∑–∫–∞ before/after —Ñ–æ—Ç–æ ‚Äî —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º API.
‚Äì –ß–µ–∫-–ª–∏—Å—Ç –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º –ø–æ–∫–∞ **—Ç–æ–ª—å–∫–æ read-only** (–∏–∑–º–µ–Ω–µ–Ω–∏—è –±—É–¥–µ–º –≤–≤–æ–¥–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ñ–∞–∑–æ–π).

---

## Phase 11.1 ‚Äî Freeze & Guards (Mobile Cleaner)

–ú–æ–±–∏–ª—å–Ω—ã–π execution-core –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω: —ç–∫—Ä–∞–Ω JobDetailsScreen –∏ `api/client.ts` –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ (Login ‚Üí Today Jobs ‚Üí Job Details ‚Üí Check-in ‚Üí Photos ‚Üí Checklist ‚Üí Check-out ‚Üí PDF). –í –∫–æ–¥–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞—â–∏—Ç–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–∞–¥ —Ö–µ–Ω–¥–ª–µ—Ä–∞–º–∏ (`handleCheckIn`, `handleCheckOut`, `handleTakePhoto`, `handleSharePdf`, checklist-handler) –∏ API-–≤—ã–∑–æ–≤–∞–º–∏, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–µ —Ç–æ—á–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞: –Ω–µ –º–µ–Ω—è—Ç—å –ø–æ—Ä—è–¥–æ–∫ —à–∞–≥–æ–≤, –Ω–µ —Ç—Ä–æ–≥–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç payload‚Äô–æ–≤, –Ω–µ –º–µ–Ω—è—Ç—å URL –±–µ–∑ —Ä–µ–≤—å—é backend + Manager Portal + PDF. –†–∞–∑—Ä–µ—à–µ–Ω—ã —Ç–æ–ª—å–∫–æ –∫–æ—Å–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∫–∏ UI; –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –≤ —ç—Ç–∏—Ö —Ñ–∞–π–ª–∞—Ö –¥–µ–ª–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —è–≤–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –∏ –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–æ–≥–æ–Ω–∞ —Ñ–ª–æ—É.

### GPS Handling (Mobile)

All GPS access is routed through `getGpsPayload` in `utils/gps.ts`.

Modes:

* DEV: forces job coordinates to bypass distance checks
* PROD: uses real device GPS via `expo-location`

Do not inline GPS logic in screens.
Do not bypass backend distance validation.
Any GPS-related changes must happen in `utils/gps.ts` only.

## Phase 11.2 ‚Äî Production GPS wrapper (mobile)

–í `mobile-cleaner/src/utils/gps.ts` –¥–æ–±–∞–≤–ª–µ–Ω `getGpsPayload`, –∫–æ—Ç–æ—Ä—ã–π —Å–Ω–∞—á–∞–ª–∞ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —á–µ—Ä–µ–∑ `expo-location` (foreground permission), –∞ –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ/–æ—à–∏–±–∫–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã job –∫–∞–∫ fallback –¥–ª—è –¥–µ–≤-–æ–∫—Ä—É–∂–µ–Ω–∏—è. `JobDetailsScreen` –±–æ–ª—å—à–µ –Ω–µ —à–ª—ë—Ç –∂—ë—Å—Ç–∫–æ –∑–∞—à–∏—Ç—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã ‚Äî –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –ø—Ä–∏ check-in / check-out –≤—Å–µ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç `getGpsPayload`. –í `app.json` –ø—Ä–æ–ø–∏—Å–∞–Ω—ã –ø–µ—Ä–º–∏—à–µ–Ω—ã –¥–ª—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –∏ –∫–∞–º–µ—Ä—ã (iOS + Android), –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –ø–ª–∞–≥–∏–Ω—ã `expo-location` –∏ `expo-image-picker`, –ø—Ä–æ–µ–∫—Ç –ø—Ä–∏–≤—è–∑–∞–Ω –∫ EAS (`extra.eas.projectId`, `owner`), —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å dev-–±–∏–ª–¥—ã —á–µ—Ä–µ–∑ `eas build`.

## Phase 11.3 ‚Äî Offline groundwork (architecture only)

–î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∏–ø—ã –æ—Ñ—Ñ–ª–∞–π–Ω-–æ—á–µ—Ä–µ–¥–∏ (`src/offline/types.ts`) –∏ –∑–∞—â–∏—Ç–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ `JobDetailsScreen`. –†–µ–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ñ—Ñ–ª–∞–π–Ω-–ª–æ–≥–∏–∫–∏ (storage, retries, outbox processing) –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ –æ—Ç–ª–æ–∂–µ–Ω–∞. –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é online-first, –æ—Ñ—Ñ–ª–∞–π–Ω-–º–æ–¥–µ–ª—å –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ —Ç–æ–ª—å–∫–æ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ç–∏–ø–æ–≤ –∏ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–µ–π.

## Landing Status (Frozen)

–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è –ª–µ–Ω–¥–∏–Ω–≥–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∏ —Å–º—ã—Å–ª—É.
–î–æ–ø—É—Å—Ç–∏–º—ã —Ç–æ–ª—å–∫–æ:
* –ø—Ä–∞–≤–∫–∏ —Ç–µ–∫—Å—Ç–∞ (–∫–æ–ø–∏—Ä–∞–π—Ç, —Ç–æ–Ω, –º–∏–∫—Ä–æ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏),
* –≤–∏–∑—É–∞–ª—å–Ω–∞—è –ø–æ–ª–∏—Ä–æ–≤–∫–∞ (–∞–Ω–∏–º–∞—Ü–∏–∏, –æ—Ç—Å—Ç—É–ø—ã, —Ç–∞–π–º–∏–Ω–≥–∏),
* –∑–∞–º–µ–Ω–∞ –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤.
–ó–∞–ø—Ä–µ—â–µ–Ω–æ:
* –º–µ–Ω—è—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–ª–æ–∫–æ–≤,
* –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Å–º—ã—Å–ª–æ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏,
* –æ–±–µ—â–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—É—é backend-–ª–æ–≥–∏–∫–æ–π.

---

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç ‚Äî –µ–¥–∏–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è:

* frontend (web),
* mobile cleaner app,
* –ª—é–±–æ–≥–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞, –ø–æ–¥–∫–ª—é—á–∞—é—â–µ–≥–æ—Å—è –∫ API.

–î–æ–∫—É–º–µ–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã:

* –∫–∞–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å—Å—è,
* –∫–∞–∫–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å,
* –∫–∞–∫–∏–µ —Å—Ç–∞—Ç—É—Å—ã –∏ –æ—à–∏–±–∫–∏ –æ–∂–∏–¥–∞—Ç—å,
* —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –∏—Å—Ç–∏–Ω–æ–π –ø–æ–≤–µ–¥–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã.

**Backend ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã.**

---

## 1. Base URL

### Local

[http://127.0.0.1:8001](http://127.0.0.1:8001)

yaml
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

---

## 2. DEV-–∞–∫–∫–∞—É–Ω—Ç—ã (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û)

### Cleaner

email: [cleaner@test.com](mailto:cleaner@test.com)
password: Test1234!
role: cleaner

shell
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

### Manager

email: [manager@test.com](mailto:manager@test.com)
password: Test1234!
role: manager

yaml
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

---

## 3. Auth

### Login (Cleaner / Manager)

POST /api/auth/login/

pgsql
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

**Payload**

```json
{
  "email": "cleaner@test.com",
  "password": "Test1234!"
}
````

Response

json
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

```json
{
  "token": "abc123...",
  "user_id": 3,
  "email": "cleaner@test.com",
  "full_name": "Alex Cleaner",
  "role": "cleaner"
}
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
–í–æ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö:

makefile
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

Authorization: Token <token>

---

## 4. Jobs ‚Äî Cleaner Flow

### Today Jobs (Cleaner)

swift
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

GET /api/jobs/today/

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:

* —Ç–æ–ª—å–∫–æ jobs —Ç–µ–∫—É—â–µ–≥–æ cleaner
* —Ç–æ–ª—å–∫–æ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ (today)

### 4a. –ö–æ–Ω—Ç—Ä–∞–∫—Ç –æ—Ç–≤–µ—Ç–∞ /api/jobs/today/ (CRITICAL)

‚ö†Ô∏è –í–ê–ñ–ù–û: –∫–æ–Ω—Ç—Ä–∞–∫—Ç –ü–õ–û–°–ö–ò–ô

–û—Ç–≤–µ—Ç –ù–ï —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤.

–ü—Ä–∏–º–µ—Ä

json
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

```json
[
  {
    "id": 5,
    "location__name": "Dubai Marina Tower",
    "scheduled_date": "2026-01-17",
    "scheduled_start_time": null,
    "scheduled_end_time": null,
    "status": "scheduled"
  }
]
```

Frontend / Mobile:

* –ù–ï –æ–∂–∏–¥–∞—Ç—å `location` object
* –ù–ï –æ–∂–∏–¥–∞—Ç—å `cleaner` object
* –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª—è —Ä–æ–≤–Ω–æ –∫–∞–∫ –µ—Å—Ç—å

–ö–æ–Ω—Ç—Ä–∞–∫—Ç –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω –∏ –Ω–µ –±—É–¥–µ—Ç –º–µ–Ω—è—Ç—å—Å—è.

–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ: –Ω–µ–∑–Ω–∞–Ω–∏–µ —ç—Ç–æ–≥–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –ª–æ–º–∞–µ—Ç UI.

### Job Detail (Cleaner)

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

GET /api/jobs/<id>/

–°–æ–¥–µ—Ä–∂–∏—Ç:

* location
* cleaner
* scheduled / actual time
* checklist_items
* photos
* check_events

### 4b. Job Detail ‚Äî –≥–∞—Ä–∞–Ω—Ç–∏–∏ –∏ NULL-–ø–æ–ª—è

–ú–æ–∂–µ—Ç –±—ã—Ç—å NULL:

* `actual_start_time`
* `actual_end_time`
* `photos.before`
* `photos.after`
* `check_events` (–µ—Å–ª–∏ –¥–µ–π—Å—Ç–≤–∏–π –µ—â—ë –Ω–µ –±—ã–ª–æ)

Frontend –æ–±—è–∑–∞–Ω:

* –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å –ø—É—Å—Ç—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
* –Ω–µ —Å—á–∏—Ç–∞—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ—à–∏–±–∫–æ–π

---

## 5. Job Statuses

–í–æ–∑–º–æ–∂–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã:

* scheduled
* in_progress
* completed

–ü–µ—Ä–µ—Ö–æ–¥—ã (—Å—Ç—Ä–æ–≥–æ)

nginx
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

scheduled ‚Üí in_progress ‚Üí completed

–ù–∏–∫–∞–∫–∏—Ö –¥—Ä—É–≥–∏—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.

---

## 6. Check-in / Check-out (CRITICAL)

### Check-in

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

POST /api/jobs/<id>/check-in/

Payload

json
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

```json
{
  "latitude": 25.0763,
  "longitude": 55.1345
}
```

–£—Å–ª–æ–≤–∏—è:

* —Ç–æ–ª—å–∫–æ —Ä–æ–ª—å `cleaner`
* job –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç cleaner
* `job.status == scheduled`
* —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ location ‚â§ 100 –º

–†–µ–∑—É–ª—å—Ç–∞—Ç:

* `job.status ‚Üí in_progress`
* —Å–æ–∑–¥–∞—ë—Ç—Å—è `JobCheckEvent (check_in)`

### Check-out

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

POST /api/jobs/<id>/check-out/

Payload –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω check-in.

–£—Å–ª–æ–≤–∏—è:

* `job.status == in_progress`
* –≤—Å–µ required checklist items == completed

–†–µ–∑—É–ª—å—Ç–∞—Ç:

* `job.status ‚Üí completed`
* —Å–æ–∑–¥–∞—ë—Ç—Å—è `JobCheckEvent (check_out)`

### 6a. Edge case: GPS –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

–ï—Å–ª–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–µ –ø–æ–ª—É—á–µ–Ω—ã:

* API –≤–µ—Ä–Ω—ë—Ç 400 Bad Request

Frontend / Mobile:

* –ø–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
* –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É
* –ù–ï —Ä–µ—Ç—Ä–∞–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## 7. Checklist

–°—Ç—Ä—É–∫—Ç—É—Ä–∞
Checklist ‚Äî snapshot, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–π –∫ job.

`JobChecklistItem`:

* text
* is_completed
* is_required

–ü—Ä–∞–≤–∏–ª–∞:

* checklist —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ job
* —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ cleaner
* manager —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞–µ—Ç
* required –ø—É–Ω–∫—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ check-out

---

## 8. Photos (Before / After)

Upload

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

POST /api/jobs/<id>/photos/

Form-data

ini
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

file=<image>
type=before | after

–ü—Ä–∞–≤–∏–ª–∞:

* —Ä–æ–≤–Ω–æ 1 before + 1 after
* after –Ω–µ–ª—å–∑—è –±–µ–∑ before
* —É–¥–∞–ª–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –ø—Ä–∞–≤–∏–ª–∞–º–∏
* –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–æ–ª—å–∫–æ cleaner
* —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `status = in_progress`

EXIF

–ï—Å–ª–∏ EXIF –µ—Å—Ç—å:

* latitude / longitude –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è
* –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ location

–ï—Å–ª–∏ EXIF –Ω–µ—Ç:

* upload —Ä–∞–∑—Ä–µ—à—ë–Ω
* `exif_missing = true`

### 8a. Response –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–æ—Ç–æ

json
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

```json
{
  "id": 12,
  "photo_type": "before",
  "latitude": 25.0763,
  "longitude": 55.1345,
  "photo_timestamp": "2026-01-17T08:32:11+04:00",
  "exif_missing": false
}
```

Frontend / Mobile:

* –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `exif_missing` –¥–ª—è UI-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
* –Ω–µ —Å—á–∏—Ç–∞—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ EXIF –æ—à–∏–±–∫–æ–π

---

## 9. JobCheckEvent (Audit Trail)

–ö–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ —Å–æ–∑–¥–∞—ë—Ç —Å–æ–±—ã—Ç–∏–µ.

–¢–∏–ø—ã:

* check_in
* check_out
* photo_before
* photo_after

–ü–æ–ª—è:

* event_type
* created_at
* latitude
* longitude

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:

* Job Timeline
* Location Verification

### 9a. Job Timeline ‚Äî –ø–æ—Ä—è–¥–æ–∫ —Å–æ–±—ã—Ç–∏–π

–°–æ–±—ã—Ç–∏—è –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è:

* –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–æ `created_at ASC`

Frontend:

* —Å—Ç—Ä–æ–∏—Ç timeline —Å—Ç—Ä–æ–≥–æ –ø–æ –ø–æ—Ä—è–¥–∫—É –æ—Ç–≤–µ—Ç–∞
* –ù–ï —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç —Å–∞–º

---

## 10. Manager Endpoints

Today Jobs (Manager)

swift
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

GET /api/manager/jobs/today/

Job Detail (Manager)

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

GET /api/manager/jobs/<id>/

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Manager Portal.

---

## 11. PDF Report

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

POST /api/jobs/<id>/report/pdf/

–†–µ–∑—É–ª—å—Ç–∞—Ç:

–≤–∞–ª–∏–¥–Ω—ã–π PDF, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç:

* job
* location
* cleaner
* timestamps
* checklist
* audit events

### 11a. PDF ‚Äî –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

PDF generation –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞.

–ö–∞–∂–¥—ã–π POST:

* —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π PDF
* –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –æ—Ç—á—ë—Ç—ã –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è

Frontend:

* –Ω–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç ¬´–æ–¥–∏–Ω PDF –Ω–∞ job¬ª

---

## 12. –¢–∏–ø–æ–≤—ã–µ –æ—à–∏–±–∫–∏ API (–í–ê–ñ–ù–û)

–ö–æ–¥—ã:

* 401 Unauthorized ‚Äî –Ω–µ—Ç —Ç–æ–∫–µ–Ω–∞ / —Ç–æ–∫–µ–Ω –Ω–µ–≤–µ—Ä–µ–Ω
* 403 Forbidden ‚Äî –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–æ–ª—å / job –Ω–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
* 409 Conflict ‚Äî –Ω–µ–≤–µ—Ä–Ω—ã–π —Å—Ç–∞—Ç—É—Å / –Ω–∞—Ä—É—à–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞
* 400 Bad Request ‚Äî –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–∞–ª–µ–∫–æ / missing required checklist items

### 12a. –§–æ—Ä–º–∞—Ç –æ—à–∏–±–∫–∏ API (–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω)

json
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

```json
{
  "detail": "Human-readable error message"
}
```

Frontend:

* –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `detail` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
* –Ω–µ –ø–∞—Ä—Å–∏—Ç —Ç–µ–∫—Å—Ç –Ω–∞ –ª–æ–≥–∏–∫—É

---

## 13. –ü—Ä–∏–Ω—Ü–∏–ø—ã (–ù–ï –ù–ê–†–£–®–ê–¢–¨)

Backend = –∏—Å—Ç–∏–Ω–∞.

Frontend –Ω–µ:

* –≤—ã—á–∏—Å–ª—è–µ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É
* –º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å—ã —Å–∞–º

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è ‚Üí —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ API.
–û—à–∏–±–∫–∏ API –Ω–µ —Å–∫—Ä—ã–≤–∞—Ç—å.

---

## 14. Offline & Retry (Mobile only)

Mobile app:

* –Ω–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
* check-in / photo / checklist / check-out –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Ñ–ª–∞–π–Ω

–ü—Ä–∞–≤–∏–ª–∞:

* API –Ω–µ –∑–Ω–∞–µ—Ç –æ–± offline
* Mobile —Ö—Ä–∞–Ω–∏—Ç pending actions –ª–æ–∫–∞–ª—å–Ω–æ
* –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ ‚Äî —Å—Ç—Ä–æ–≥–æ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
* Backend —Å–∞–º –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –¥—É–±–ª–µ–π

üí° –°—Ç–∞—Ç—É—Å:

* Backend ‚Äî LOCKED
* API –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã ‚Äî –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã
* Manager Portal ‚Äî –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω
* Mobile Cleaner App ‚Äî –º–æ–∂–Ω–æ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –±–µ–∑ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–π

---

## Mobile ‚Äî Job Details (Cleaner)

–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç –º–µ–∂–¥—É Mobile Job Details —ç–∫—Ä–∞–Ω–æ–º –∏ API.
–¶–µ–ª—å: –ø–æ —ç—Ç–æ–º—É —Ç–µ–∫—Å—Ç—É –º–æ–∂–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —ç–∫—Ä–∞–Ω –±–µ–∑ –¥–æ–≥–∞–¥–æ–∫.

### 15.1. –ù–∞–≤–∏–≥–∞—Ü–∏—è –∏–∑ Today Jobs

–ò—Å—Ç–æ—á–Ω–∏–∫: GET /api/jobs/today/

–ö–∞–∂–¥–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –≤ —Å–ø–∏—Å–∫–µ Today Jobs –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:

* `id` ‚Üí —Å–∫—Ä—ã—Ç—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä job
* `location__name` ‚Üí –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞—Ä—Ç–æ—á–∫–∏ (–Ω–∞–∑–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞)
* `scheduled_date` ‚Üí —Å—Ç—Ä–æ–∫–∞ `Date: <date>`
* `status` ‚Üí —Å—Ç—Ä–æ–∫–∞ `Status: <status>`

–ü—Ä–∏ —Ç–∞–ø–µ –ø–æ –∫–∞—Ä—Ç–æ—á–∫–µ:

* –Ω–∞–≤–∏–≥–∞—Ü–∏—è –Ω–∞ —ç–∫—Ä–∞–Ω `JobDetailsScreen(jobId = id)`

‚ö†Ô∏è –ö–æ–Ω—Ç—Ä–∞–∫—Ç `/api/jobs/today/` –ü–õ–û–°–ö–ò–ô:

* –Ω–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ `location`
* –Ω–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω–æ–≥–æ `cleaner`
* —Ñ—Ä–æ–Ω—Ç –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—ã—Ç–∞—Ç—å—Å—è –∏—Ö —Ç–∞–º –∏—Å–∫–∞—Ç—å

### 15.2. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö Job Details

–ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ JobDetailsScreen:

h
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

GET /api/jobs/<id>/
Authorization: Token <token>

–û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç (–∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ):

–û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è:

* id
* status ‚Äî `scheduled` / `in_progress` / `completed`
* scheduled_date
* scheduled_start_time
* scheduled_end_time
* actual_start_time (–º–æ–∂–µ—Ç –±—ã—Ç—å null)
* actual_end_time (–º–æ–∂–µ—Ç –±—ã—Ç—å null)

location:

* name
* address
* latitude
* longitude

checklist_items: –º–∞—Å—Å–∏–≤

* id
* text
* is_completed
* is_required

photos: –º–∞—Å—Å–∏–≤ (0‚Äì2 —ç–ª–µ–º–µ–Ω—Ç–æ–≤)

* photo_type ‚Äî `"before"` | `"after"`
* file_url
* latitude (–º–æ–∂–µ—Ç –±—ã—Ç—å null)
* longitude (–º–æ–∂–µ—Ç –±—ã—Ç—å null)
* photo_timestamp (–º–æ–∂–µ—Ç –±—ã—Ç—å null)
* exif_missing (bool, –µ—Å–ª–∏ –µ—Å—Ç—å –≤ –æ—Ç–≤–µ—Ç–µ)

check_events: –º–∞—Å—Å–∏–≤

* event_type ‚Äî `"check_in"` | `"check_out"`
* event_timestamp
* latitude
* longitude

–ì–∞—Ä–∞–Ω—Ç–∏–∏:

* `actual_start_time`, `actual_end_time`, `photos`, `check_events` –º–æ–≥—É—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å / –±—ã—Ç—å null ‚Äî —ç—Ç–æ –Ω–µ –æ—à–∏–±–∫–∞;
* `check_events` –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é;
* —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–µ –º–µ–Ω—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫, –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–∞–∫ –µ—Å—Ç—å.

### 15.3. Header / Basic Info ‚Üî API

–ù–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–≤–µ—Ç–∞ `GET /api/jobs/<id>/`:

* –∑–∞–≥–æ–ª–æ–≤–æ–∫ —ç–∫—Ä–∞–Ω–∞: `location.name`
* –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫: `scheduled_date`
* —Å—Ç–∞—Ç—É—Å (badge / —Ç–µ–∫—Å—Ç): `status`

–ë–ª–æ–∫ –∞–¥—Ä–µ—Å–∞:

* label: `Address`
* –∑–Ω–∞—á–µ–Ω–∏–µ: `location.address`

### 15.4. –°—Ç–∞—Ç—É—Å –∏ –¥–µ–π—Å—Ç–≤–∏—è (Check-in / Check-out)

–í–æ–∑–º–æ–∂–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã job (–ø–æ–≤—Ç–æ—Ä):

* scheduled ‚Üí in_progress ‚Üí completed

–î—Ä—É–≥–∏—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –Ω–µ—Ç.

#### 15.4.1. –°–æ—Å—Ç–æ—è–Ω–∏–µ scheduled

UI:

* –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å: `Status: scheduled`
* –∫–Ω–æ–ø–∫–∞ Check-in ‚Äî –∞–∫—Ç–∏–≤–Ω–∞
* –∫–Ω–æ–ø–∫–∏ Upload Photo / Check-out:

  * –ª–∏–±–æ —Å–∫—Ä—ã—Ç—å
  * –ª–∏–±–æ –ø–æ–∫–∞–∑–∞—Ç—å –≤ disabled (–ª–æ–≥–∏–∫–∞ –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–∞ backend)

API:

h
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

POST /api/jobs/<id>/check-in/
Authorization: Token <token>
Content-Type: application/json

```json
{
  "latitude": <device_lat>,
  "longitude": <device_lng>
}
```

–£—Å–ª–æ–≤–∏—è –Ω–∞ backend:

* —Ç–æ–ª—å–∫–æ —Ä–æ–ª—å `cleaner`
* job –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —ç—Ç–æ–º—É cleaner
* `job.status == "scheduled"`
* —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ ‚â§ 100 –º –æ—Ç `location.latitude/longitude`

–ï—Å–ª–∏ GPS –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω / –Ω–µ –ø–æ–ª—É—á–µ–Ω—ã –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:

* —Ñ—Ä–æ–Ω—Ç –ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç API
* –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ—à–∏–±–∫—É: `"Can't get location, please try again"`

–û—Ç–≤–µ—Ç (—É—Å–ø–µ—Ö):

* `job.status` –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `in_progress`
* –≤ `check_events` –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Å–æ–±—ã—Ç–∏–µ `event_type = "check_in"`

UI:

* –æ–±–Ω–æ–≤–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ job –∏–∑ –æ—Ç–≤–µ—Ç–∞
* –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å —ç–∫—Ä–∞–Ω –∫–∞–∫ `in_progress`

–û—à–∏–±–∫–∏:

* 400 Bad Request ‚Äî –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–∞–ª–µ–∫–æ –æ—Ç location
* 401 / 403 ‚Äî –ø—Ä–æ–±–ª–µ–º—ã —Å —Ç–æ–∫–µ–Ω–æ–º / —Ä–æ–ª—å—é
* 409 Conflict ‚Äî job —É–∂–µ –Ω–µ –≤ —Å—Ç–∞—Ç—É—Å–µ `scheduled`

–§—Ä–æ–Ω—Ç:

* –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é `detail` –∏–∑ –æ—Ç–≤–µ—Ç–∞
* –Ω–µ –º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å –ª–æ–∫–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –Ω–µ—É—Å–ø–µ—à–µ–Ω

#### 15.4.2. –°–æ—Å—Ç–æ—è–Ω–∏–µ in_progress

UI:

* –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å: `Status: in_progress`

–ë–ª–æ–∫ Check-in:

* —Ç–µ–∫—Å—Ç: `Checked in at <time>`
* –≤—Ä–µ–º—è –±–µ—Ä—ë—Ç—Å—è –∏–∑:

  * `actual_start_time`, –µ—Å–ª–∏ –µ—Å—Ç—å
  * –∏–Ω–∞—á–µ ‚Äî –ø–µ—Ä–≤–æ–≥–æ `check_events` —Å `event_type="check_in"`

–ö–Ω–æ–ø–∫–∏:

* Upload Before Photo ‚Äî –∞–∫—Ç–∏–≤–Ω–∞, –µ—Å–ª–∏ –≤ `photos` –µ—â—ë –Ω–µ—Ç `photo_type="before"`;
* Upload After Photo ‚Äî –∞–∫—Ç–∏–≤–Ω–∞, –µ—Å–ª–∏:

  * –µ—Å—Ç—å `photo_type="before"`
  * –Ω–µ—Ç `photo_type="after"`
* Check-out ‚Äî –∞–∫—Ç–∏–≤–Ω–∞ –≤—Å–µ–≥–¥–∞ –ø—Ä–∏ `status="in_progress"` (backend –≤—Å—ë —Ä–∞–≤–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç —á–µ–∫–ª–∏—Å—Ç –∏ —Ñ–æ—Ç–æ).

#### 15.4.3. –°–æ—Å—Ç–æ—è–Ω–∏–µ completed

UI:

* –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å: `Status: completed`

–ë–ª–æ–∫ Check-in / Check-out:

* `Checked in at <time>` (—Å–º. –≤—ã—à–µ)
* `Checked out at <time>`:

  * `actual_end_time`, –µ—Å–ª–∏ –µ—Å—Ç—å
  * –∏–Ω–∞—á–µ ‚Äî `event check_out` –∏–∑ `check_events`

–ö–Ω–æ–ø–∫–∏:

* Check-in / Upload / Check-out ‚Üí —Å–∫—Ä—ã—Ç—ã –∏–ª–∏ disabled

–ù–∏–∫–∞–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è job —á–µ—Ä–µ–∑ –º–æ–±–∏–ª—å–Ω—ã–π –Ω–µ –¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è.

### 15.5. Photos Block ‚Üî API

–≠–∫—Ä–∞–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–≤–∞ —Å–ª–æ—Ç–∞:

* Before photo
* After photo

#### 15.5.1. –ß—Ç–µ–Ω–∏–µ

–ò–∑ `photos`:

* –æ–±—ä–µ–∫—Ç —Å `photo_type="before"` ‚Üí —Å–ª–æ—Ç Before
* –æ–±—ä–µ–∫—Ç —Å `photo_type="after"` ‚Üí —Å–ª–æ—Ç After

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ—Ç–∞:

* –ø—Ä–µ–≤—å—é: `file_url`
* –ø–æ–¥–ø–∏—Å—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): –≤—Ä–µ–º—è –∏–∑ `photo_timestamp`
* –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä EXIF (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

  * –µ—Å–ª–∏ `exif_missing == true` ‚Üí –ø–æ–º–µ—Ç–∏—Ç—å `"No EXIF"` –∏–ª–∏ –∏–∫–æ–Ω–∫–æ–π

#### 15.5.2. –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ

Before:

http
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

POST /api/jobs/<id>/photos/
Authorization: Token <token>
Content-Type: multipart/form-data

file=<image binary>
type=before

After:

http
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

POST /api/jobs/<id>/photos/
Authorization: Token <token>
Content-Type: multipart/form-data

file=<image binary>
type=after

–û—Ç–≤–µ—Ç (–ø—Ä–∏–º–µ—Ä, –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –¥–ª—è –æ–±–æ–∏—Ö —Ç–∏–ø–æ–≤):

json
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

```json
{
  "id": 12,
  "photo_type": "before",
  "file_url": "https://...",
  "latitude": 25.0763,
  "longitude": 55.1345,
  "photo_timestamp": "2026-01-17T08:32:11+04:00",
  "exif_missing": false
}
```

UI:

* –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –æ–±–Ω–æ–≤–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Å–ª–æ—Ç
* –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `file_url` –¥–ª—è –ø—Ä–µ–≤—å—é

Backend-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:

* –º–∞–∫—Å–∏–º—É–º 1 before –∏ 1 after –Ω–∞ job
* after –Ω–µ–ª—å–∑—è –∑–∞–≥—Ä—É–∂–∞—Ç—å, –µ—Å–ª–∏ –Ω–µ—Ç before
* –∑–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `status="in_progress"`

–û—à–∏–±–∫–∏:

* 409 Conflict ‚Äî –ø–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å –ª–∏—à–Ω—é—é —Ñ–æ—Ç–∫—É –∏–ª–∏ after –±–µ–∑ before
* 400 Bad Request ‚Äî —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ –æ—Ç location –ø–æ EXIF

–í –ª—é–±–æ–º —Å–ª—É—á–∞–µ —Ñ—Ä–æ–Ω—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `detail` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

---

### 15.6. Checklist Block ‚Üî API

–ò—Å—Ç–æ—á–Ω–∏–∫: `checklist_items` –∏–∑ `GET /api/jobs/<id>/`.

–ö–∞–∂–¥—ã–π –ø—É–Ω–∫—Ç:

* —Ç–µ–∫—Å—Ç ‚Üí `text`
* —á–µ–∫–±–æ–∫—Å ‚Üí `is_completed`
* required:

  * –µ—Å–ª–∏ `is_required == true` ‚Üí –≤–∏–∑—É–∞–ª—å–Ω–æ –ø–æ–º–µ—á–∞–µ–º (–∑–≤—ë–∑–¥–æ—á–∫–∞ / —Ü–≤–µ—Ç)

–ò–∑–º–µ–Ω–µ–Ω–∏–µ —á–µ–∫–ª–∏—Å—Ç–∞:

* –Ω–∞–∂–∞—Ç–∏–µ –Ω–∞ —á–µ–∫–±–æ–∫—Å –º–µ–Ω—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
* —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ backend —á–µ—Ä–µ–∑ endpoint bulk-update —á–µ–∫–ª–∏—Å—Ç–∞

backend –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:

* –∞–≤—Ç–æ—Ä ‚Äî cleaner
* `job.status == "in_progress"`

–ü—Ä–∏ –æ—à–∏–±–∫–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, job —É–∂–µ `completed`):

* –ø–æ–∫–∞–∑—ã–≤–∞–µ–º `detail`
* –æ—Ç–∫–∞—Ç—ã–≤–∞–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ

---

### 15.7. Check-out Block ‚Üî API

–ö–Ω–æ–ø–∫–∞ Check-out –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏ `status == "in_progress"`.

–ó–∞–ø—Ä–æ—Å:

http
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

POST /api/jobs/<id>/check-out/
Authorization: Token <token>
Content-Type: application/json

```json
{
  "latitude": <device_lat>,
  "longitude": <device_lng>
}
```

–£—Å–ª–æ–≤–∏—è –Ω–∞ backend:

* job –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç cleaner
* `status == "in_progress"`
* –≤—Å–µ required checklist items ‚Üí `is_completed = true`
* –µ—Å—Ç—å –∏ before, –∏ after —Ñ–æ—Ç–æ
* —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ ‚â§ 100 –º

–û—Ç–≤–µ—Ç (—É—Å–ø–µ—Ö):

* `job.status ‚Üí completed`
* –≤ `check_events` –ø–æ—è–≤–ª—è–µ—Ç—Å—è `check_out`
* `actual_end_time` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

UI:

* –æ–±–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ job –∏–∑ –æ—Ç–≤–µ—Ç–∞
* –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å —ç–∫—Ä–∞–Ω –∫–∞–∫ `completed`
* –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –±–∞–Ω–Ω–µ—Ä `"Job Completed"`

–û—à–∏–±–∫–∏:

* 400 Bad Request ‚Äî –¥–∞–ª–µ–∫–æ –æ—Ç —Ç–æ—á–∫–∏ / –Ω–µ –≤—Å–µ required –ø—É–Ω–∫—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
* 409 Conflict ‚Äî –Ω–µ–≤–µ—Ä–Ω—ã–π —Å—Ç–∞—Ç—É—Å job

–§—Ä–æ–Ω—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `detail` –∏ –ù–ï –º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å –ª–æ–∫–∞–ª—å–Ω–æ.

---

### 15.8. Timeline (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ –Ω—É–∂–µ–Ω –≤–∏–∑—É–∞–ª—å–Ω—ã–π —Ç–∞–π–º–ª–∞–π–Ω:

* –±–µ—Ä—ë–º `check_events`
* –æ–Ω–∏ —É–∂–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (ASC)
* —Å—Ç—Ä–æ–∏–º —Å–ø–∏—Å–æ–∫:

  * check_in ‚Üí `"Checked in at <time>"`
  * check_out ‚Üí `"Checked out at <time>"`

–≠—Ç–æ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π UI, –ª–æ–≥–∏–∫–∞ API –æ—Ç –Ω–µ–≥–æ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç.

---

### DEV BRIEF ‚Äî Job Details stability rules

–ö–æ–Ω—Ç–µ–∫—Å—Ç:
–≠–∫—Ä–∞–Ω Job Details —Ä–∞–Ω–µ–µ –±—ã–ª —Ä–∞–±–æ—á–∏–º, –Ω–æ –±—ã–ª —Å–ª–æ–º–∞–Ω —Å–µ—Ä–∏–µ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π. –í —ç—Ç–æ–º —ç—Ç–∞–ø–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è.

–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

1. Job Details Screen ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Ç–æ—á–∫–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏.

   * UI-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (sections / blocks) –æ—Å—Ç–∞—é—Ç—Å—è dumb.
   * –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è (check-in, check-out, upload photo, checklist) —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å–≤–µ—Ä—Ö—É.

2. –ü–æ—Å–ª–µ –ª—é–±–æ–≥–æ mutating action:

   * –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è refetch job details,
   * UI –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –æ–±—Ö–æ–¥ backend.

3. GPS:

   * –≤ DEV –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∑–∞–¥–∞—á–∏,
   * –≤ PROD –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–π GPS.

4. –§–æ—Ç–æ:

   * –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω—ã–π API `expo-image-picker`,
   * `mediaTypes` –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Å—Ç—Ä–æ–≥–æ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏,
   * –ª—é–±—ã–µ –∫–∞—Å—Ç—ã `as any` –¥–æ–ø—É—Å—Ç–∏–º—ã —Ç–æ–ª—å–∫–æ –∫–∞–∫ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.

5. Confirm modals:

   * –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –¥–ª—è Check-in –∏ Check-out,
   * –∑–∞—â–∏—â–∞—é—Ç –æ—Ç —Å–ª—É—á–∞–π–Ω—ã—Ö –Ω–∞–∂–∞—Ç–∏–π,
   * —Å—á–∏—Ç–∞—é—Ç—Å—è —á–∞—Å—Ç—å—é UX-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞.

6. –õ–æ–≥–∏:

   * `console.log` –≤ API –∏ screens –Ω–µ –¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è,
   * –¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ debug-–ª–æ–≥–∏ —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º —É–¥–∞–ª–µ–Ω–∏–µ–º.

–ó–∞–ø—Ä–µ—â–µ–Ω–æ:

* –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –≤ —Å–µ–∫—Ü–∏—è—Ö,
* ¬´—á–∏–Ω–∏—Ç—å¬ª UI –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è backend-—Å–æ—Å—Ç–æ—è–Ω–∏—è,
* —É–¥–∞–ª—è—Ç—å dev-—Ö–µ–ª–ø–µ—Ä—ã –±–µ–∑ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã.

```
